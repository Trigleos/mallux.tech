<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Game Hacking Part I -Mallux </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Hack a Unity game by patching the source- Game Hacking Part I"> <meta name="keywords" content="Game Hacking Part I, Mallux, Csharp, Reversing, Windows_Reversing,.NET Reversing, Unity game patching, Reversing, C# Reversing"/> <meta content="" property="fb:app_id" /> <meta content="Mallux" property="og:site_name" /> <meta content="Game Hacking Part I" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Hack a Unity game by patching the source" property="og:description" /> <meta content="/blog/game-hacking-part-1/" property="og:url" /> <meta content="2020-10-12T18:00:00+00:00" property="article:published_time" /> <meta content="/about/" property="article:author" /> <meta content="/assets/img/posts/game-hacking-part-1/thumbnail.png" property="og:image" /> <meta content="Csharp" property="article:section" /> <meta content="Windows" property="article:tag" /> <meta content="Reversing," property="article:tag" /> <meta content="Reversing," property="article:tag" /> <meta content="C#" property="article:tag" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Game Hacking Part I" /> <meta name="twitter:url" content="/blog/game-hacking-part-1/" /> <meta name="twitter:description" content="Hack a Unity game by patching the source" /> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = '' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <!-- for Mathjax support --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Mallux</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Game Hacking Part I</h1> <h4 class="post-meta">Hack a Unity game by patching the source</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="/blog/authors/trigleos">trigleos</a></span> </span > at <time datetime="2020-10-12 18:00:00 +0000" itemprop="datePublished" >Oct 12, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/game-hacking-part-1/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Csharp" >Csharp</a > &nbsp; <a href="/blog/categories/Reversing" >Reversing</a > &nbsp; <a href="/blog/categories/Windows_Reversing" >Windows_Reversing</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="/assets/img/posts/game-hacking-part-1/thumbnail.png" alt="" /> <br /> <br /> <h1 id="follow-the-white-rabbit">Follow the white rabbit</h1> <h2 id="tldr">TL;DR</h2> <p>Hacking a Unity game to access hidden areas and patch new content in</p> <h2 id="description">Description</h2> <p>Since I’ve encountered a hacker for the first time in a game, I’ve always wondered how they manage to exploit the mechanics in a way to fly or become unvincible. After I started participating in CTFs, I soon encountered the Windows Reversing category, where the executable is often a .NET executable or a Unity game. Both of these can be easily reversed, due to the fact that they are interpreted languages and thus produce a bytecode that is interpreted by the CLR (Common Language Runtime). I started loving this category and by hunger for challenges got satisfied when Stackoverflow released his Follow the white rabbit challenge, a game written in Unity that was part of the CSCG 2020. This post will explore several hacks and explain how I got the two flags hidden in the game. So let’s dive into the wonderful and fun world of game hacking</p> <p><img src="/assets/img/posts/game-hacking-part-1/thumbnail.png" alt="game" /></p> <h2 id="exploring-the-game">Exploring the game</h2> <p>First of all, what stackoverflow has created here just for a CTF challenge is amazing and I have seldomly seen challenges that are this much fleshed out. We got thrown into a beautiful medieval/futuristic world (weird combination I know). After looking around for a bit, we see a white rabbit. Following him like the challenge indicates us to, we get to a hole in the ground. The rabbit, without even thinking about it, just jumps into the hole</p> <p><img src="/assets/img/posts/game-hacking-part-1/rabbit_suicide.gif" alt="rabbit suicide" /></p> <p>However, if we try to follow him, this happens:</p> <p><img src="/assets/img/posts/game-hacking-part-1/death.gif" alt="death" /></p> <p>We clearly need to do something to survive this fall. So let’s code our first hack</p> <h2 id="no-fall-damage-hack">No Fall damage hack</h2> <p>Diving into the game’s assemblies, we soon find the PlayerController class which has a checkFallDeath function.</p> <p><img src="/assets/img/posts/game-hacking-part-1/check_fall_death.png" alt="csharp" /></p> <p>It’s a fairly easy function, and we clearly need to remove the call to Die() so our character isn’t killed when he falls to the bottom of the hole. So let’s just replace it by a nice and simple print(“Hello”) After making this change, we no longer die at the bottom of the hole and we can easily walk to the first flag</p> <p><img src="/assets/img/posts/game-hacking-part-1/flag.png" alt="flag" /></p> <p>But now that we have it, how can we exit the cave? It’s time for another hack</p> <h2 id="fly-hack">Fly hack</h2> <p>In order to leave the cave again, we need to implement a fly hack, Let’s take a look into the PlayerController class again, this time however into the CalculateVerticalMovement() function. The important part of the function looks like this:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">else</span>  <span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_IsGrounded</span><span class="p">)</span>  
<span class="p">{</span>  
    <span class="k">this</span><span class="p">.</span><span class="n">m_VerticalSpeed</span>  <span class="p">=</span>  <span class="p">-</span><span class="k">this</span><span class="p">.</span><span class="n">gravity</span>  <span class="p">*</span>  <span class="m">0.3f</span><span class="p">;</span>  
    <span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_Input</span><span class="p">.</span><span class="n">JumpInput</span>  <span class="p">&amp;&amp;</span>  <span class="k">this</span><span class="p">.</span><span class="n">m_ReadyToJump</span><span class="p">)</span>  
    <span class="p">{</span>  
        <span class="k">this</span><span class="p">.</span><span class="n">m_VerticalSpeed</span>  <span class="p">=</span>  <span class="k">this</span><span class="p">.</span><span class="n">jumpSpeed</span><span class="p">;</span>  
        <span class="k">this</span><span class="p">.</span><span class="n">m_ReadyToJump</span>  <span class="p">=</span>  <span class="k">false</span><span class="p">;</span>  
    <span class="p">}</span>  
<span class="p">}</span>
</code></pre></div></div> <p>There are two problems in this code that prevent us from continously jumping after we’re up in the air. First of all, the function checks if the player is grounded before it increases the player’s vertical speed so we need to remove that check. Second, the ReadyToJump variable is set to false after we’ve jumped once so let’s change that to true. Our updated code will look like this:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">else</span>  
<span class="p">{</span>  
    <span class="k">this</span><span class="p">.</span><span class="n">m_VerticalSpeed</span>  <span class="p">=</span>  <span class="p">-</span><span class="k">this</span><span class="p">.</span><span class="n">gravity</span>  <span class="p">*</span>  <span class="m">0.3f</span><span class="p">;</span>  
    <span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_Input</span><span class="p">.</span><span class="n">JumpInput</span>  <span class="p">&amp;&amp;</span>  <span class="k">this</span><span class="p">.</span><span class="n">m_ReadyToJump</span><span class="p">)</span>  
    <span class="p">{</span>  
        <span class="k">this</span><span class="p">.</span><span class="n">m_VerticalSpeed</span>  <span class="p">=</span>  <span class="k">this</span><span class="p">.</span><span class="n">jumpSpeed</span><span class="p">;</span>  
        <span class="k">this</span><span class="p">.</span><span class="n">m_ReadyToJump</span>  <span class="p">=</span>  <span class="k">true</span><span class="p">;</span>  
    <span class="p">}</span>  
<span class="p">}</span>
</code></pre></div></div> <p>After making these changes, we can easily fly out of the cave and explore the island more easily. Here, you can see the hack in action:</p> <p><img src="/assets/img/posts/game-hacking-part-1/flyhack.gif" alt="fly hack" /></p> <p>I will follow up this post with a second one where I implement a speed hack as well as patching new content into the game to get the second flag.</p> <p>-Trigleos</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="/blog/game-hacking-part-1/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Pol Thill </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="/assets/img/authors/trigleos.png" alt="Pol Thill" /> </div> <div class="col-md-6"> <p class="author_bio">Hi I am Pol, a Cybersecurity student.</p> <p>Email : pthill99@gmail.com</p> <p>Website : https://trigleos.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/trigleos" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/pol-thill-985b02190" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/tr3gleos" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> </div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Mallux</div> <div class="card-body"> <p class="author_bio">Mallux is a blog where I write about Cybersecurity.</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Csharp"></div> <li class="tag-head"> <a href="/blog/categories/Csharp">Csharp</a> </li> <a name="Csharp"></a> <div id="#Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Reversing">Reversing</a> </li> <a name="Reversing"></a> <div id="#Windows_Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Windows_Reversing">Windows_Reversing</a> </li> <a name="Windows_Reversing"></a> <div id="#Assembly"></div> <li class="tag-head"> <a href="/blog/categories/Assembly">Assembly</a> </li> <a name="Assembly"></a> <div id="#Linux_Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Linux_Reversing">Linux_Reversing</a> </li> <a name="Linux_Reversing"></a> <div id="#Ransomware"></div> <li class="tag-head"> <a href="/blog/categories/Ransomware">Ransomware</a> </li> <a name="Ransomware"></a> <div id="#Networking"></div> <li class="tag-head"> <a href="/blog/categories/Networking">Networking</a> </li> <a name="Networking"></a> <div id="#Forensics"></div> <li class="tag-head"> <a href="/blog/categories/Forensics">Forensics</a> </li> <a name="Forensics"></a> <div id="#RSA"></div> <li class="tag-head"> <a href="/blog/categories/RSA">RSA</a> </li> <a name="RSA"></a> <div id="#AES"></div> <li class="tag-head"> <a href="/blog/categories/AES">AES</a> </li> <a name="AES"></a> <div id="#Threat_Hunting"></div> <li class="tag-head"> <a href="/blog/categories/Threat_Hunting">Threat_Hunting</a> </li> <a name="Threat_Hunting"></a> <div id="#Incident_Response"></div> <li class="tag-head"> <a href="/blog/categories/Incident_Response">Incident_Response</a> </li> <a name="Incident_Response"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="/">Home</a> </li> <li> <a href="/blog">Blog</a> </li> </div> </div> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted on <a href="https://www.netlify.com/">Netlify</a>. </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <script src="/assets/js/mode-switcher.js"></script> </body> </html>
