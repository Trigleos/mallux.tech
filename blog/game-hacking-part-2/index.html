<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Game Hacking Part II -Mallux </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Hack a Unity game by patching the source- Game Hacking Part II"> <meta name="keywords" content="Game Hacking Part II, Mallux, Csharp, Reversing, Windows_Reversing,.NET Reversing, Unity game patching, Reversing, C# Reversing"/> <meta content="" property="fb:app_id" /> <meta content="Mallux" property="og:site_name" /> <meta content="Game Hacking Part II" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Hack a Unity game by patching the source" property="og:description" /> <meta content="/blog/game-hacking-part-2/" property="og:url" /> <meta content="2020-10-16T18:00:00+00:00" property="article:published_time" /> <meta content="/about/" property="article:author" /> <meta content="/assets/img/posts/game-hacking-part-1/thumbnail.png" property="og:image" /> <meta content="Csharp" property="article:section" /> <meta content="Windows" property="article:tag" /> <meta content="Reversing," property="article:tag" /> <meta content="Reversing," property="article:tag" /> <meta content="C#" property="article:tag" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Game Hacking Part II" /> <meta name="twitter:url" content="/blog/game-hacking-part-2/" /> <meta name="twitter:description" content="Hack a Unity game by patching the source" /> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = '' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <!-- for Mathjax support --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Mallux</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Game Hacking Part II</h1> <h4 class="post-meta">Hack a Unity game by patching the source</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="/blog/authors/trigleos">trigleos</a></span> </span > at <time datetime="2020-10-16 18:00:00 +0000" itemprop="datePublished" >Oct 16, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/game-hacking-part-2/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Csharp" >Csharp</a > &nbsp; <a href="/blog/categories/Reversing" >Reversing</a > &nbsp; <a href="/blog/categories/Windows_Reversing" >Windows_Reversing</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="/assets/img/posts/game-hacking-part-1/thumbnail.png" alt="" /> <br /> <br /> <h1 id="follow-the-white-rabbit">Follow the white rabbit</h1> <h2 id="tldr">TL;DR</h2> <p>Hacking a Unity game to access hidden areas and patch new content in</p> <h2 id="description">Description</h2> <p>This is the second part of a two part series. In this part, we’ll try to implement more hacks and patch more content into the game</p> <h2 id="recap">Recap</h2> <p>In part 1, we discovered the first flag as well as implement a No Fall Damage Hack and a Fly Hack.</p> <h2 id="speed-hack">Speed Hack</h2> <p>Let’s try to create a speed hack so we can explore the island more easily. Again, let’s focus mostly on the Player Movement class because that’s where most of the calculations take place. To increase running speed, we’ll take a look at the CalculateForwardMovement() function where the important part looks like this:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="n">m_DesiredForwardSpeed</span>  <span class="p">=</span>  <span class="n">moveInput</span><span class="p">.</span><span class="n">magnitude</span>  <span class="p">*</span>  <span class="k">this</span><span class="p">.</span><span class="n">maxForwardSpeed</span><span class="p">;</span>  
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="kt">float</span>  <span class="n">num</span>  <span class="p">=</span>  <span class="k">this</span><span class="p">.</span><span class="n">IsMoveInput</span>  <span class="p">?</span>  <span class="m">5f</span>  <span class="p">:</span>  <span class="m">40f</span><span class="p">;</span>  
<span class="k">this</span><span class="p">.</span><span class="n">m_ForwardSpeed</span>  <span class="p">=</span>  <span class="n">Mathf</span><span class="p">.</span><span class="nf">MoveTowards</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_ForwardSpeed</span><span class="p">,</span>  <span class="k">this</span><span class="p">.</span><span class="n">m_DesiredForwardSpeed</span><span class="p">,</span>  <span class="n">num</span>  <span class="p">*</span>  <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
</code></pre></div></div> <p>What we need to change here is first of all somehow increase this.maxForwardSpeed which isn’t set by default. By searching through the code, we can find the following reference:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="n">maxForwardSpeed</span>  <span class="p">=</span>  <span class="k">this</span><span class="p">.</span><span class="n">maxSprintSpeed</span><span class="p">;</span>
</code></pre></div></div> <p>So we now know that we need to change this.maxSprintSpeed which in turn is set by default to 10 so let’s increase it to 100. Second, let’s multiply this.m_DesiredForwardSpeed by 10f so it also increases after the program has started. The code now looks like this:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="n">m_DesiredForwardSpeed</span>  <span class="p">=</span>  <span class="n">moveInput</span><span class="p">.</span><span class="n">magnitude</span>  <span class="p">*</span>  <span class="k">this</span><span class="p">.</span><span class="n">maxForwardSpeed</span>  <span class="p">*</span>  <span class="m">10f</span><span class="p">;</span>  
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="kt">float</span>  <span class="n">num</span>  <span class="p">=</span>  <span class="k">this</span><span class="p">.</span><span class="n">IsMoveInput</span>  <span class="p">?</span>  <span class="m">5f</span>  <span class="p">:</span>  <span class="m">40f</span><span class="p">;</span>  
<span class="k">this</span><span class="p">.</span><span class="n">m_ForwardSpeed</span>  <span class="p">=</span>  <span class="n">Mathf</span><span class="p">.</span><span class="nf">MoveTowards</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_ForwardSpeed</span><span class="p">,</span>  <span class="k">this</span><span class="p">.</span><span class="n">m_DesiredForwardSpeed</span><span class="p">,</span>  <span class="n">num</span>  <span class="p">*</span>  <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">);</span>
</code></pre></div></div> <p>And the speed hack works perfectly</p> <h2 id="searching-for-content">Searching for content</h2> <p>After implementing these hacks, we can easily explore the island and soon discover another rabbit that has a message for us:</p> <p><img src="/assets/img/posts/game-hacking-part-2/rabbit.png" alt="rabbit" /></p> <p>It seems that we have to wait for an update so we can find the second flag. But what if the update is already included in the executable. Let’s investigate with utinyRipper that can extract Unity object files from finished Unity games. After doing that, we can open the extracted project in Unity and have a look around. We can find a scene that’s not part of the finished game. So let’s change the code a bit to patch it in. Because one of the only inputs we can control in the game is the Jump input, we’ll change the behaviour of the calculateVerticalMovement function and add an if clause:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_Input</span><span class="p">.</span><span class="n">JumpInput</span>  <span class="p">&amp;&amp;</span>  <span class="n">SceneManager</span><span class="p">.</span><span class="nf">GetActiveScene</span><span class="p">().</span><span class="n">name</span>  <span class="p">==</span>  <span class="s">"FlagLand"</span>  <span class="p">&amp;&amp;</span>  <span class="k">this</span><span class="p">.</span><span class="n">load</span><span class="p">)</span>  
	<span class="p">{</span>  
	<span class="k">this</span><span class="p">.</span><span class="n">load</span>  <span class="p">=</span>  <span class="k">false</span><span class="p">;</span>  
	<span class="n">Scene</span>  <span class="n">activeScene</span>  <span class="p">=</span>  <span class="n">SceneManager</span><span class="p">.</span><span class="nf">GetActiveScene</span><span class="p">();</span>  
	<span class="n">SceneManager</span><span class="p">.</span><span class="nf">LoadScene</span><span class="p">(</span><span class="m">5</span><span class="p">,</span>  <span class="n">LoadSceneMode</span><span class="p">.</span><span class="n">Additive</span><span class="p">);</span>  
	<span class="n">SceneManager</span><span class="p">.</span><span class="nf">MergeScenes</span><span class="p">(</span><span class="n">SceneManager</span><span class="p">.</span><span class="nf">GetSceneByBuildIndex</span><span class="p">(</span><span class="m">5</span><span class="p">),</span>  <span class="n">activeScene</span><span class="p">);</span>  
<span class="p">}</span>
</code></pre></div></div> <p>This code checks for Jump input and then loads the formerly unimplemented scene and merges it with our current active scene. Let’s give this a try and see if we can find the new scene. <img src="/assets/img/posts/game-hacking-part-2/update.png" alt="update" /> And there it is. Now the only question that remains is how to get into the house. It’s time for our last hack.</p> <h2 id="teleport-hack">Teleport Hack</h2> <p>We will again change the calculateVerticalMovement function by adding an if clause so we get teleported into the house once we click the space bar long enough. Following is the added code:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m_Input</span><span class="p">.</span><span class="n">JumpInput</span><span class="p">)</span>  
<span class="p">{</span>  
	<span class="k">this</span><span class="p">.</span><span class="n">timer</span>  <span class="p">+=</span>  <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span>  
	<span class="k">if</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">timer</span>  <span class="p">&gt;</span>  <span class="m">3f</span><span class="p">)</span>  
	<span class="p">{</span>  
		<span class="k">this</span><span class="p">.</span><span class="n">timer</span>  <span class="p">=</span>  <span class="m">0f</span><span class="p">;</span>  
		<span class="n">GameObject</span>  <span class="n">gameObject</span>  <span class="p">=</span>  <span class="n">GameObject</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">"Player"</span><span class="p">);</span>  
		<span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>  
		<span class="n">gameObject</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span>  <span class="p">=</span>  <span class="k">new</span>  <span class="nf">Vector3</span><span class="p">(-</span><span class="m">82f</span><span class="p">,</span>  <span class="m">217f</span><span class="p">,</span>  <span class="m">25f</span><span class="p">);</span>  
		<span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>    
	<span class="p">}</span>  
<span class="p">}</span>
</code></pre></div></div> <p>The timer checks if we hold down the button for three seconds before we get teleported. The rest of the code just deals with moving the player to the correct position. Finding the correct coordinates involved some trial and error for me but there might be a way to do it faster. So let’s see the hack in action. <img src="/assets/img/posts/game-hacking-part-2/teleport.gif" alt="teleport hack" /> And finally, let’s get a good look at the final flag <img src="/assets/img/posts/game-hacking-part-2/flag.png" alt="flag" /> So that’s it for this short series about Windows Game Hacking, I hope you liked it and probs to LiveOverflow for creating this awesome challenge. He created another harder one and I might tackle it at some point in the future and will of course also post it here. Thank you for visiting my blog and have a good day</p> <p>-Trigleos</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="/blog/game-hacking-part-2/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Pol Thill </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="/assets/img/authors/trigleos.png" alt="Pol Thill" /> </div> <div class="col-md-6"> <p class="author_bio">Hi I am Pol, a Cybersecurity student.</p> <p>Email : pthill99@gmail.com</p> <p>Website : https://trigleos.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/trigleos" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/pol-thill-985b02190" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/tr3gleos" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> </div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Mallux</div> <div class="card-body"> <p class="author_bio">Mallux is a blog where I write about Cybersecurity.</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Csharp"></div> <li class="tag-head"> <a href="/blog/categories/Csharp">Csharp</a> </li> <a name="Csharp"></a> <div id="#Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Reversing">Reversing</a> </li> <a name="Reversing"></a> <div id="#Windows_Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Windows_Reversing">Windows_Reversing</a> </li> <a name="Windows_Reversing"></a> <div id="#Assembly"></div> <li class="tag-head"> <a href="/blog/categories/Assembly">Assembly</a> </li> <a name="Assembly"></a> <div id="#Linux_Reversing"></div> <li class="tag-head"> <a href="/blog/categories/Linux_Reversing">Linux_Reversing</a> </li> <a name="Linux_Reversing"></a> <div id="#Ransomware"></div> <li class="tag-head"> <a href="/blog/categories/Ransomware">Ransomware</a> </li> <a name="Ransomware"></a> <div id="#Networking"></div> <li class="tag-head"> <a href="/blog/categories/Networking">Networking</a> </li> <a name="Networking"></a> <div id="#Forensics"></div> <li class="tag-head"> <a href="/blog/categories/Forensics">Forensics</a> </li> <a name="Forensics"></a> <div id="#RSA"></div> <li class="tag-head"> <a href="/blog/categories/RSA">RSA</a> </li> <a name="RSA"></a> <div id="#AES"></div> <li class="tag-head"> <a href="/blog/categories/AES">AES</a> </li> <a name="AES"></a> <div id="#Threat_Hunting"></div> <li class="tag-head"> <a href="/blog/categories/Threat_Hunting">Threat_Hunting</a> </li> <a name="Threat_Hunting"></a> <div id="#Incident_Response"></div> <li class="tag-head"> <a href="/blog/categories/Incident_Response">Incident_Response</a> </li> <a name="Incident_Response"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="/">Home</a> </li> <li> <a href="/blog">Blog</a> </li> </div> </div> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted on <a href="https://www.netlify.com/">Netlify</a>. </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <script src="/assets/js/mode-switcher.js"></script> </body> </html>
